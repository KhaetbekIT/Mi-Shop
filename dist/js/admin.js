(()=>{"use strict";let e="http://localhost:3001";const t=t=>(t=e+t,fetch(t).then((e=>e.json()))),n=(t,n)=>(t=e+t,fetch(t,n).then((e=>e.json()))),a=t=>(t=e+t,fetch(t,{method:"DELETE"}).then((e=>e.json())));(()=>{const e=document.querySelector("#category-name"),r=document.querySelector("#category-image"),d=document.querySelector("#category-add-btn"),o=document.querySelector("#category-container"),c=document.querySelector("#product-category"),i={name:"",image:""},u=()=>{""===e.value.trim()||""===r.value.trim()?d.disabled=!0:d.disabled=!1},l=()=>{t("/catalog").then((e=>{o.innerHTML="",e.map(((e,t)=>{const{id:n,name:a}=e;o.insertAdjacentHTML("beforeend",`\n                    <tr>\n                        <th scope="row">${t+1}</th>\n                        <td>${a}</td>\n                        <td class="text-end">\n                            <button type="button" class="btn btn-outline-danger btn-sm" data-category-id="${n}">\n                                удалить\n                            </button>\n                        </td>\n                    </tr>\n                `),c.insertAdjacentHTML("beforeend",`\n                    <option value="${n}">${a}</option>\n                `)}))}))};e.addEventListener("input",(()=>{i.name=e.value,u()})),r.addEventListener("input",(()=>{const e=r.files[0];if("image/jpeg"===e.type||"image/jpg"===e.type||"image/png"===e.type){const t=new FileReader;t.addEventListener("load",(()=>{i.image=t.result})),t.addEventListener("error",(()=>{i.image="",r.value=""})),t.readAsDataURL(e)}else r.value="";u()})),d.addEventListener("click",(()=>{n("/catalog",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}).then((t=>{r.value="",e.value="",l()}))})),o.addEventListener("click",(e=>{if("BUTTON"===e.target.tagName){const t=e.target.dataset.categoryId;a(`/catalog/${t}`).then((e=>{l()}))}})),l(),u()})(),(()=>{const e=document.querySelector("#product-title"),r=document.querySelector("#product-name"),d=document.querySelector("#product-price"),o=document.querySelector("#product-image"),c=document.querySelector("#product-save-button"),i=document.querySelector("#product-category"),u=document.querySelector("#product-container"),l={title:"",productName:"",image:"",price:0,category:0},s=()=>{t("/products").then((e=>{u.innerHTML="",e.map(((e,t)=>{const{title:n,productName:a,price:r,id:d}=e;u.insertAdjacentHTML("beforeend",`\n                    <tr>\n                        <th scope="row">${t+1}</th>\n                        <td>${a}</td>\n                        <td>${n}</td>\n                        <td>${r} ₽</td>\n                        <td class="text-end">\n                            <button type="button" class="btn btn-outline-danger btn-sm" data-product-id="${d}">\n                                удалить\n                            </button>\n                        </td>\n                    </tr>\n                `)}))}))},p=()=>{""===e.value.trim()||""===r.value.trim()||0===Number(d.value.trim())||""===o.value.trim()||"default"===i.value?c.disabled=!0:c.disabled=!1};i.addEventListener("change",(()=>{p()})),e.addEventListener("input",(()=>{l.title=e.value})),r.addEventListener("input",(()=>{l.productName=r.value})),d.addEventListener("input",(()=>{l.price=Number(d.value)})),o.addEventListener("input",(()=>{const e=o.files[0];if("image/jpeg"===e.type||"image/jpg"===e.type||"image/png"===e.type){const t=new FileReader;t.addEventListener("load",(()=>{l.image=t.result})),t.addEventListener("error",(()=>{l.image="",o.value=""})),t.readAsDataURL(e)}else o.value="";p()})),c.addEventListener("click",(()=>{n("/products",{method:"POST",body:JSON.stringify(l),headers:{"Content-Type":"application/json"}}).then((t=>{e.value="",r.value="",d.value=0,o.value="",s()}))})),u.addEventListener("click",(e=>{if("BUTTON"===e.target.tagName){const t=e.target.dataset.productId;a(`/products/${t}`).then((()=>{s()}))}})),p(),s()})()})();